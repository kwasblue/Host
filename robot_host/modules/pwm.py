from robot_host.core.client import AsyncRobotClient
from robot_host.core.event_bus import EventBus


class PwmHostModule:
    """PWM_SET helper.

    Wraps the autogenerated cmd_pwm_set() on AsyncRobotClient.
    """

    def __init__(self, bus: EventBus, client: AsyncRobotClient) -> None:
        self._bus = bus
        self._client = client

    async def set(self, channel: int, duty: float, freq_hz: float | None = None) -> None:
        # Use the generated helper so CMD_PWM_SET stays in the mixin.
        await self._client.cmd_pwm_set(
            channel=int(channel),
            duty=float(duty),
            freq_hz=float(freq_hz) if freq_hz is not None else None,
        )
